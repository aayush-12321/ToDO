{% extends "task/base.html" %}
{% block title %}Task List{% endblock %}

{% block content %}

<!-- <div class="container mt-3" id="alertContainer"></div> -->
{% if messages %}
<div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1055;">
  {% for message in messages %}
  <div class="toast align-items-center text-bg-{{ message.tags }} border-0 show" role="alert" aria-live="assertive"
    aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">
        {{ message }}
      </div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
        aria-label="Close"></button>
    </div>
  </div>
  {% endfor %}
</div>
{% endif %}



<div class="container-sm">
  <!-- <div class="container-sm" style="border: 2px solid red;"> -->
  <div class="my-3 mx-auto w-75">
    <a class="btn btn-success mt-3 " href="{% url 'task-create' %}">Add Task</a>
    <p class="mt-2 text-info">You have <em>{{count}}</em> incomplete task{{count|pluralize}}!!!</p>
  </div>


  <!-- Tasks -->

  {% for task in tasks %}

  <div class="card w-75 my-3 mx-auto">

    <div class="row g-0 align-items-center">
      <!-- 10/12 width -->
      <div class="col-12 col-md-9">
        <div class="card-body">
          <h5 class="card-title"> {% if task.complete %} &#128994; {% else %} &#8709; {% endif %} {{ task.title|upper }}
          </h5>
          {% if task.complete %}
          <p class="card-text">
            <em><s>{% if task.description|length > 15 %}
                {{ task.description|slice:":15" }}... </s></em>
            {% else %}
            <em><s>{{ task.description }} </s> </em>
            {% endif %}
          </p>

          {% else %}
          <p class="card-text">
            {% if task.description|length > 15 %}
            {{ task.description|slice:":15" }}...
            {% else %}
            {{ task.description }}
            {% endif %}</p>
          {% endif %}

          <a href="{% url 'task' task.id%}" class="btn btn-success">View</a>
          <a href="{% url 'task-update' task.id%}" class="btn btn-primary">Edit</a>
          <!-- <a href="{% url 'task-delete' task.id%}" class="btn btn-danger">Delete</a> -->
          <!-- <a href="" class="btn btn-danger" onclick="">Delete</a> -->
          <!-- Trigger Button -->

          <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal"
            data-task-id="{{ task.id }}" data-task-title="{{ task.title }}"
            data-delete-url="{% url 'task-delete' task.id %}">
            Delete
          </button>


        </div>
      </div>

    </div>
  </div>

  {% empty %}
  <h3>No Items Added.</h3>
  {% endfor %}

</div>

<!-- Delete Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form id="deleteForm" method="POST">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="deleteModalBody">
          <!-- JS will insert task title here -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-danger">Yes, Delete</button>
        </div>
      </form>
    </div>
  </div>
</div>


{% endblock %}